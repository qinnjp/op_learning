**1.什么是url?**

1. url表示一个资源(它可以是图片 视频 音频)    连接地址

   url简称统一资源定位符.用来唯一标识万维网中唯一的资源.由协议主机和端口(默认为80)以及文件名3部分构成.

2. url组成部分:

   https://  zhidao.baidu.com:80            /question/68334350.html

   协议         主机名称|域名     端口(默认)   文件的路径

   - 协议     http https

   - 域名     

   - 端口       80    443

   - 路径       /public/tt.jpeg   --->   Uri

   - 查询        key-value

     https:// 

     search.jd.com/Search

     ?keyword=手机&    查询

     enc=utf-8

     &wq=手机&

     pvid=b7038cef753649f89e1029f9612113d5

**2. 什么是html?**

​    html简称Web Page,只不过一个完整的Html页面可能会包含很多个URL的资源.

​    (我们可以理解文一个html文件是由多个不同的URL资源拼接而成的.)

**3. 什么是http?**

- 超文本传输协议

- http协议就是将用户请求的HTMT页面从一台web服务器传输到客户端浏览器的一种协议
- web 上进行数据交换的基础.

**4. url html http 之间的关系**

- 一个完整的HTMl页面是由N多个Url地址资源组成的,而http协议是用来传输这种Html文件的.

![1568276460575](C:\Users\Thinkpad\AppData\Roaming\Typora\typora-user-images\1568276460575.png)

**5. http的工作原理**

> 1.用户输入域名->浏览器跳转->浏览器缓存->Hosts文件->DNS解析( 递归查询 | 迭代查询 )
> 客户端向服务端发起查询->递归查询
> 服务端向服务端发起查询->迭代查询
> 2.由浏览器向服务端发起TCP连接（三次握手）
> 客户端  -->请求包连接-syn=1 seq=x           服务端
> 服务端  -->向应客户端syn=1 ack=x+1 seq=y    客户端
> 客户端  -->建立连接  ack=y+1 seq=x+1        服务端
> 3.客户端发起http请求：
>
> 1.请求的方法是什么： Get 获取
> 2.请求的Host主机是： www.oldboyedu.com
> 3.请求的资源是什么： /index.html
> 4.请求的端口是什么： 默认http是80  https 443
> 5.请求携带的参数是： 属性（请求的类型、压缩、认证、浏览器信息、等等）
> 6.请求最后的空行
>
> 4.服务端响应的内容是
>
> 1.服务端响应使用的WEB服务软件
> 2.服务端响应请求文件的类型
> 3.服务端响应请求的文件是否进行压缩
> 4.服务端响应请求的主机是否进行长连接
> 5.客户端向服务端发起TCP断开（四次挥手）
> 客户端  --> 断开请求 fin=1 seq=x           -->      服务端
> 服务端  --> 响应断开 fin=1 ack=x+1 seq=y   -->      客户端
> 服务端  --> 断开连接 fin=1 ack=x+1 seq=z   -->      客户端
> 客户端  --> 确认断开 fin=1 ack=z+1 seq=sj  -->      服务端

**6.当用户在浏览器输入域名后,会发生那些操作? dns tcp http**

用户 --> app cache --> dns --> tcp握手 --> http request --> http response --> tcp挥手

> 1.客户端发起http请求，请求会先抵达前端的防火墙
> 2.防火墙识别用户身份，正常的请求通过内部交换机通过tcp连接后端的负载均衡，传递用户的http请求
> 3.负载接收到请求，会根据请求的内容进行下发任务，通过tcp连接后端的web，转发发用户的http请求
> 4.web接收到用户的http请求后，会根据用户请求的内容进行解析，解析分为如下：
> 静态请求:web直接返回给负载均衡->防火墙->用户
> 动态请求:web向后端的动态程序建立TCP连接，将用户的动态http请求传递至动态程序->由动态程序进行解析
> 5.动态程序在解析的过程中，如果碰到查询数据库请求，则优先与缓存建立tcp连接，并发起数据查询操作。
> 6.如果缓存没有对应的数据，动态程序再次向数据库建立tcp连接，并发起查询操作。
> 7.最后数据由, 数据库->动态程序->缓存->web服务->负载均衡->防火墙->用户。

![1569501033656](C:\Users\Thinkpad\AppData\Roaming\Typora\typora-user-images\1569501033656.png)



**7. 抓包分析**

- 第一步: 浏览器分析超链接中的URL

- 第二步:dns请求

  PC向dns服务器180.76.76.76发送dns query请求,请求fj.xuliangwei.com的A记录

![1568278703991](C:\Users\Thinkpad\AppData\Roaming\Typora\typora-user-images\1568278703991.png)

- 第三步:DNS回复

  DNS服务器180.76.76.76回复DNS response,解析出fj.xuliangwei.com域名对应的一条A记录

![1568279045423](C:\Users\Thinkpad\AppData\Roaming\Typora\typora-user-images\1568279045423.png)

- 第四步:建立tcp连接

  PC向DNS解析fj.xuliangwei.com地址发起tcp三次握手

![1568279323080](C:\Users\Thinkpad\AppData\Roaming\Typora\typora-user-images\1568279323080.png)

- 第五步:Http请求

  PC向fj.xuliangwei.com服务器发出GET请求,请求主页

![1568279559804](C:\Users\Thinkpad\AppData\Roaming\Typora\typora-user-images\1568279559804.png)

- 第六步:Http响应

  fj.xuliangwei.com服务器回应HTTP/1.1 200 OK ,返回主页数据包

![1568279787571](C:\Users\Thinkpad\AppData\Roaming\Typora\typora-user-images\1568279787571.png)

- 第七步:连接断开

  完成交互过程,四次挥手断开连接

![1568281061435](C:\Users\Thinkpad\AppData\Roaming\Typora\typora-user-images\1568281061435.png)

- 第八步:总结

  整个用户访问网站过程就是DNS-TCP-HTTP

![1568280132957](C:\Users\Thinkpad\AppData\Roaming\Typora\typora-user-images\1568280132957.png)

**8. http请求headers  响应Headers 响应状态码**

- 请求headers

~~~bash
Request URL: http://10.0.0.7/					#请求的域名
Request Method: GET								#请求的方法  获取
Status Code: 200 OK								#状态码 200
Remote Address: 10.0.0.7:80						#请求的真实IP地址+端口
Referrer Policy: no-referrer-when-downgrade		#TTPS页面引入HTTP资源）时不发送Referrer信息
--------------------------------------------------------------------
Accept: text/html,application/xhtml+xml			# 接受资源类型
Accept-Encoding: gzip, deflate					# 压缩方式
Accept-Language: zh-CN,zh;q=0.9					# 使用语言
Cache-Control: no-cache							# 缓存控制
Connection: keep-alive							# 保持连接, 长连接
Host: 10.0.0.7									# 请求的域名
Pragma: no-cache								# 请求的参数 , no-cache  没有缓存
Upgrade-Insecure-Requests: 1					# 在http和https之间起的一个过渡作用
User-Agent: Mozilla/5.0 						# 请求的设备

#3.服务端响应的头部信息

HTTP/1.1 304 Not Modified                       # 返回服务器的http协议，状态码
Date: Fri, 14 Sep 2018 09:14:28 GMT             # 返回服务器的时间（GMT时间）+8小时=传统时间
Server: Apache/2.4.6 (CentOS) PHP/5.4.16        # 返回服务器使用的软件（Apache php）
Connection: Keep-Alive                          # TCP长连接
Keep-Alive: timeout=5, max=100                  # 长连接的超时时间
"=== 返回一个空行 ==="
"=== 返回内容主体 ==="
~~~

请求的方法:
	

| 标记   | 动作             | 举例     |
| ------ | ---------------- | -------- |
| GET    | 获取服务器的资源 | 看朋友圈 |
| POST   | 提交数据至服务器 | 发朋友圈 |
| DELETE |                  | 删朋友圈 |

什么是长连接,什么是短连接.
	短连接 表示的是 http1.0协议时代,  一次连接一次请求,效率较低.		
	长连接 表示的是 http1.1协议时代,  一次连接,多次请求,效率较高.
	http2.0 一次连接，多次请求，多次回应，效率高
	http3.0
	https://http2.akamai.com/demo/http2-lab.html

- 响应headres

Connection: Keep-Alive							# 保持连接,长链接
Content-Length: 115								# 响应内容的长度
Content-Type: text/html;charset=utf-8			# 响应内容的类型
Date: Thu, 12 Sep 2019 02:12:38 GMT				# 响应的日期 GMT+8小时=北京时间
Keep-Alive: timeout=5, max=100					# 长连接超时时间5s,最大100s
Server: Apache/2.4.6 (CentOS) PHP/5.4.16		# 服务器使用的web软件  php java

1xx（临时响应）
表示临时响应并需要请求者继续执行操作的状态代码。
代码 说明
http状态码 100 （继续） 请求者应当继续提出请求。 服务器返回此代码表示已收到请求的第一部分，正在等待其余部分。
http状态码 101 （切换协议） 请求者已要求服务器切换协议，服务器已确认并准备切换。

2xx （成功）
表示成功处理了请求的状态代码。
代码 说明
http状态码 200 （成功） 服务器已成功处理了请求。 通常，这表示服务器提供了请求的网页。
http状态码 201 （已创建） 请求成功并且服务器创建了新的资源。
http状态码 202 （已接受） 服务器已接受请求，但尚未处理。
http状态码 203 （非授权信息） 服务器已成功处理了请求，但返回的信息可能来自另一来源。
http状态码 204 （无内容） 服务器成功处理了请求，但没有返回任何内容。
http状态码 205 （重置内容） 服务器成功处理了请求，但没有返回任何内容。
http状态码 206 （部分内容） 服务器成功处理了部分 GET 请求。





> 3xx （重定向）
>
> 表示要完成请求，需要进一步操作。 通常，这些状态代码用来重定向。
> 代码 说明
> http状态码 300 （多种选择） 针对请求，服务器可执行多种操作。 服务器可根据请求者 (user agent) 选择一项操作，或提供操作列表供请求者选择。
> http状态码 301 （永久跳转） 请求的网页已永久移动到新位置。 服务器返回此响应（对 GET 或 HEAD 请求的响应）时，会自动将请求者转到新位置。
> http状态码 302 （临时跳转） 服务器目前从不同位置的网页响应请求，但请求者应继续使用原有位置来进行以后的请求。
> http状态码 303 （查看其他位置） 请求者应当对不同的位置使用单独的 GET 请求来检索响应时，服务器返回此代码。
> http状态码 304 （未修改） 自从上次请求后，请求的网页未修改过。 服务器返回此响应时，不会返回网页内容。
> http状态码 305 （使用代理） 请求者只能使用代理访问请求的网页。 如果服务器返回此响应，还表示请求者应使用代理。
> http状态码 307 （内部跳转） 服务器目前从不同位置的网页响应请求，但请求者应继续使用原有位置来进行以后的请求。
>
> 
>
> 4xx（请求错误）
> 这些状态代码表示请求可能出错，妨碍了服务器的处理。
> 代码 说明
> http状态码 400 （错误请求） 服务器不理解请求的语法。
> http状态码 401 （未授权） 请求要求身份验证。 对于需要登录的网页，服务器可能返回此响应。
> http状态码 403 （禁止）服务端返回不了首页给客户端。
> http状态码 404 （未找到） 服务器找不到请求的网页。
> http状态码 405 （方法禁用） 禁用请求中指定的方法。
> http状态码 406 （不接受） 无法使用请求的内容特性响应请求的网页。
> http状态码 407 （需要代理授权） 此状态代码与 401（未授权）类似，但指定请求者应当授权使用代理。
> http状态码 408 （请求超时） 服务器等候请求时发生超时。
> http状态码 409 （冲突） 服务器在完成请求时发生冲突。 服务器必须在响应中包含有关冲突的信息。
> http状态码 410 （已删除） 如果请求的资源已永久删除，服务器就会返回此响应。
> http状态码 411 （需要有效长度） 服务器不接受不含有效内容长度标头字段的请求。
> http状态码 412 （未满足前提条件） 服务器未满足请求者在请求中设置的其中一个前提条件。
> http状态码 413 （请求实体过大） 服务器无法处理请求，因为请求实体过大，超出服务器的处理能力。
> http状态码 414 （请求的 URI 过长） 请求的 URI（通常为网址）过长，服务器无法处理。
> http状态码 415 （不支持的媒体类型） 请求的格式不受请求页面的支持。
> http状态码 416 （请求范围不符合要求） 如果页面无法提供请求的范围，则服务器会返回此状态代码。
> http状态码 417 （未满足期望值） 服务器未满足”期望”请求标头字段的要求。
>
> 5xx（服务器错误）
> 这些状态代码表示服务器在尝试处理请求时发生内部错误。 这些错误可能是服务器本身的错误，而不是请求出错。
> 代码 说明
> http状态码 500 （服务器内部错误） 服务器遇到错误，无法完成请求。
> http状态码 501 （尚未实施） 服务器不具备完成请求的功能。 例如，服务器无法识别请求方法时可能会返回此代码。
> http状态码 502 （错误网关） 服务器作为网关或代理，从上游服务器收到无效响应。
> http状态码 503 （服务不可用） 服务器目前无法使用（由于超载或停机维护）。 通常，这只是暂时状态。
> http状态码 504 （网关超时） 服务器作为网关或代理，但是没有及时从上游服务器收到请求。
> http状态码 505 （HTTP 版本不受支持） 服务器不支持请求中所用的 HTTP 协议版本。





**9. 额外headrest信息**

user-agent 	请求浏览器的工具 设备
Referer字段    记录从哪一个页面过来的
Location		WEB 服务器告诉浏览器，试图访问的对象已经被移到别的位置了

**10.ip pv uv 并发 日活 月活**

并发: 10s  500  * 6 * 60 * 24 = 4320000  430w

假设公司有一座大厦，大厦有100人，每个人有一台电脑和一部手机，上网都是通过NAT转换，每个人刷新网站10次，请问对应的 pv，uv，ip，并发 分别是多少。
	ip: 	1个  NAT
	pv: 	100 *2 * 10 = 2000
	uv: 	100 *2 = 200
	并发: 	单位时间内(3s 5s 10s) 能够支持多少 请求   200
	3ms  5000  3s   单位时间内(10s) 能否支持最大的请求 5000

pv:  100000000  / 24 / 60 / 60 =  1158/s
uv:  10000000
ip:  1000000

